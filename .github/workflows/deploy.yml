name: ğŸš€ CI/CD Pipeline

on:
  push:
    branches:
      - main  # ğŸ”¥ Triggers the pipeline on pushes to the main branch

jobs:
  alpha:  # âœ… Stage 1: Alpha (Unit Testing)
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ” Debug Directory Structure
        run: ls -R
        working-directory: .  # âœ… Check folder structure

      - name: âš™ï¸ Set Up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ Install Dependencies
        run: npm ci
        working-directory: .  # âœ… Corrected path

      - name: ğŸ” Debug Installed Packages
        run: npm list --depth=0

      - name: ğŸ“¦ Install Dependencies2
        run: npm install --include=dev

      - name: âœ… Run Unit Tests
        run: npm test --verbose


    #   - name: âœ… Run Unit Tests
    #     run: npx test
    #     working-directory: .


## BELOW WILL BE RUN POST INTEGRATION TESTING IS COMPLETED



  beta:  # âœ… Stage 2: Beta (Integration Testing)
    needs: alpha  # ğŸ›‘ Only runs if 'alpha' stage passes
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: âš™ï¸ Set Up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ Install Dependencies
        run: npm install
        working-directory: .

      - name: ğŸ”¬ Run Integration Tests
        run: npm run test:integration  # âœ… Run integration tests (replace with correct command)
        working-directory: .

  prod:  # âœ… Stage 3: Production Deployment
    needs: beta  # ğŸ›‘ Only runs if 'beta' stage passes
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: âš™ï¸ Set Up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ Install Dependencies
        run: npm install
        working-directory: .

      - name: ğŸ—ï¸ Build Project
        run: npm run build  # âœ… Modify this for your build process
        working-directory: .

      - name: ğŸš€ Deploy Application
        run: |
          echo "ğŸš€ Deploying application..."
          # ğŸ”¥ Add deployment commands here (e.g., SSH, AWS, Firebase)
